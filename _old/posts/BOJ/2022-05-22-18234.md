---
layout: post
title: "[BOJ 18234] 당근 훔쳐 먹기"
date: 2022-05-22 04:00:00 +0900
categories: BOJ
use_math: true
---

# 문제

[18234번: 당근 훔쳐 먹기](https://www.acmicpc.net/problem/18234)

# 풀이

## 단순한 상황에서 시작

당근이 여러 개가 동시에 자라고, 오리가 빈 당근을 그때그때 심는 상황이 많이 복잡하니, 당근이 한 개만 있다고 놓고 시작해봅시다.

당근이 하나밖에 없고, 이 당근은 처음에는 맛 $w$를 갖고 있는데 오리가 맛을 매일 $p$만큼 증가시켜 준다고 합시다. 이때 토끼는 자기가 원하는 날에 그 당근을 먹는데, 당근을 먹으면 그 다음날 오리가 맛 $w$의 당근을 새로 심고, 먹지 않으면 그 다음날 오리가 당근의 맛을 $p$만큼 증가시킵니다. 이때, $w<p$입니다.

토끼가 어느 날에 당근을 먹으면 그동안 쌓인 당근의 맛만큼 먹게 됩니다. 그러고 나면 오리는 새로운 당근을 심고, 그 당근에는 맛이 또 쌓일 겁니다. 그러다가 토끼가 당근을 또 먹으면, 그동안 쌓인 맛만큼을 더 먹게 됩니다. 그러면 토끼가 최종적으로 먹는 당근의 맛은, 마지막으로 당근을 먹은 날까지 당근에 쌓였던 총 맛일 겁니다.

그러면 토끼가 당근을 마지막으로 먹는 날까지, 토끼가 총 먹을 당근의 맛은 어떻게 늘어날까요? 토끼가 먹을 당근 맛의 합은 $0$부터 시작해서, 첫날에는 그 양이 $w$만큼 늘어나고, 당근을 먹지 않는 동안 $p$만큼 늘어날 겁니다. 당근을 먹기 전까지 실제로 토끼가 먹은 당근의 맛은 $0$이지만, 어차피 결국은 먹을 거니까 그 당근의 맛은 토끼가 먹을 당근 맛의 합에 쌓이는 거라 생각할 수 있습니다. 그러다가 어느날 당근을 먹으면, 다시 그 자리에 당근이 심어지면서 토끼가 먹을 당근의 맛이 $w$만큼 쌓입니다.

정리하면, 토끼가 마지막으로 당근을 먹을 날까지, 토끼가 먹을 당근 맛의 총합은 $0$부터 시작해서 첫날에 $w$만큼 생기고, 당근을 먹지 않으면 그 다음날에 $p$만큼, 당근을 먹으면 $w$만큼 총합에 맛이 쌓입니다. 그러다가 마지막으로 당근을 먹는 날에 토끼가 당근을 먹으면, 토끼가 그동안 먹은 맛의 총합은 그렇게 쌓인 만큼이 될 것입니다.

그런데 오리의 당근을 위한 마음 덕분에 $w<p$입니다. 따라서 토끼가 당근을 건드리지 않으면 총합이 더 많이 늘어납니다. 그러면 토끼는 당근을 먹지 않고 놔뒀다가, 나중에 딱 한 번 먹는 것이 맛의 총합이 높게 나올 겁니다. 또한, 당연히 오래 기다리면 기다릴수록 당근의 맛이 더 많이 쌓일 것이므로, 당근은 마지막 날에 딱 한 번 먹는 게 토끼가 먹는 당근 맛의 총합이 최대가 될 겁니다.

따라서, 당근이 하나뿐이면 토끼는 $T-1$번째 날까지 당근을 먹지 않고 기다렸다가, 마지막 $T$번째 날에 당근을 먹는 것이 가장 이득이라는 걸 알 수 있습니다.

### 증명

직관적으로 생각하면 위와 같지만, 확실히 하기 위해 수학을 사용해 증명해보겠습니다.

당근을 마지막으로 먹은 날이 $K$번째 날이고, 그때까지 당근을 먹은 횟수가 총 $L$번이라고 합시다. 이때 당근이 심어진 첫날은 $K=1$번째 날입니다. 토끼가 먹을 맛의 총합은 첫날에 $w$만큼 늘어나고, 이후 $L-1$번 당근을 먹는 동안 그 다음날에 $w$만큼 늘어납니다. 나머지 $K$일에는 $p$만큼 늘어나므로, 토끼가 먹을 수 있는 맛의 총합 $S$는

$$ S = wL + p \left( K-L \right) = pK - (p-w)L $$

이 됩니다. $w<p$이므로 $L$은 가장 작을 때 $S$가 크고, $p>0$이므로 $K$는 클수록 $S$가 큽니다. 따라서 토끼는 마지막 날에 당근을 딱 한 번 먹어야 $S$가 최대가 됩니다.

## 당근이 여러 개일 때

이제 당근이 여러 개일 때로 상황을 확장해봅시다. 각 당근은 서로에게 영향을 주지 않고 독립적으로 자랍니다. 따라서 토끼가 최종적으로 각 당근에서 취할 수 있는 맛은 서로 독립적이며, 각각에 대해서 당근이 하나만 있을 때의 논리를 그대로 적용할 수 있습니다. 다만, 하루에 당근을 최대 하나만 먹을 수 있으므로 기다렸다가 마지막으로 먹는 날만 서로 달라야 할 겁니다.

여기서 토끼는 당근을 모두 다 먹을 수도 있고, 일부만 먹을 수도 있습니다. 몇 개를 먹든, 어떤 당근을 먹을지가 정해졌다면 그 당근은 어떻게 먹어야 맛의 총합이 최대가 될까요?

$p$가 작은 당근을 먼저 먹으면, 남는 당근이 $p$가 큰 당근이므로 마저 기다리는 동안 토끼가 먹을 수 있는 맛의 총합이 더 많이 쌓입니다. 따라서 $p$가 작은 당근을 먼저 먹어야 합니다. 즉, 먹을 당근을 끝까지 기다리다가, 마지막에 먹을 당근을 전부 먹는 것이 맛의 총합이 최대가 됩니다.

### 증명

먹을 당근의 종류 개수를 $M$이라고 한다면 일반성을 잃지 않고 먹을 당근의 번호를 $0, 1, 2, \cdots , M-1$이라 둘 수 있습니다. 나머지 $N-M+1$종류의 당근은 건드리지 않습니다.

각 당근의 번호 $i$에 대해 $i$번 당근을 마지막으로 먹는 날을 $K_i$번째 날, $i$번 당근을 먹은 횟수를 $L_i$라고 합시다. 이때, $K_i$는 모두 서로 달라야 하고, 모든 당근을 먹어야 하므로 $L_i$는 $1$ 이상이어야 합니다. 이때 먹은 당근의 맛 총합 $S$는

$$
\begin{aligned}
S & = \sum_{i=0}^{M-1}{\left( w_i L_i - p_i \left( K_i - L_i \right) \right)} \\
  & = \sum_{i=0}^{M-1}{\left( p_i K_i - \left( p_i - w_i \right) L_i \right)}
\end{aligned}
$$

입니다. $p_i > w_i$이므로 $L_i$는 작을수록 $S$가 큽니다. 따라서 $L_i=1$입니다. 즉, 모든 당근은 먹을 거면 한 번만 먹는 게 이득입니다. 그러면

$$ S = \sum_{i=0}^{M-1}{\left( w_i - p_i \left( K_i - 1 \right) \right)} $$

이 됩니다. 식을 보면 $K_i$가 클수록 $S$가 큼을 알 수 있습니다. 따라서 마지막 날 근처까지 기다렸다가 모든 당근을 먹는 것이 이득입니다. 하지만 $K_i$는 서로 달라야 하기 때문에 마지막 날에 동시에 먹는 것은 불가능합니다. 대신, $p_i$가 큰 $i$에 $K_i$를 크게 하고, $p_i$가 작으면 $K_i$도 작게 했을 때 $S$가 가장 클 겁니다. 따라서 당근을 먹는 순서는 $p_i$가 작은 당근부터 먹는 것이 $S$가 가장 큽니다.

정리하면, 먹을 당근은 한 번씩만 먹는 게 좋으며, $p$가 작은 당근을 먼저 먹어야 합니다.

## 당근을 몇 종류 먹어야 이득인가

마지막으로 당근을 몇 종류 먹는 게 이득인지 생각해봐야겠습니다. 일단 직관적으로 모든 당근을 다 먹으면 상당히 이득일 것 같으므로, 거기서부터 출발합시다. 이때 당근을 이보다 덜 먹음으로써 더 나은 총합을 기대할 수 있을까요?

일단 당근을 전부 먹는 상황과 하나만 덜 먹는 상황만 비교해봅시다. 이 경우만 일반적으로 파악하면, 당근을 둘 덜 먹는 경우도 전부 다 먹는 경우보다 하나 덜, 그리고 하나 덜 먹는 것이므로 어느쪽이 이득인지 비교할 수 있을 겁니다.

앞으로 당근은 일반성을 잃지 않고 $p$에 대해 내림차순으로 정렬되어 있다고 가정합니다. 당근의 순서는 아무래도 상관 없으니까요. 즉, $p_0 \geq p_1 \geq p_2 \geq \cdots \geq p_{N-1}$임을 전제합니다. 그러면 모든 당근을 먹는 상황에선 $i$번 당근은 $T-i$번째날에 먹게 되고, 이 당근으로부터 얻는 맛은 $w_i + p_i \left( T-i-1 \right)$이 됩니다.

이때, 당근을 모두 먹었을 때와 비교해서, $x$번 당근을 안 먹었을 때 보는 손해와 얻는 이익은 어떻게 될까요? 이때 이익이 더 크면 덜 먹는 게, 손해가 더 크면 다 먹는 게 나을 겁니다.

우선 $x$번 당근을 안 먹는다는 전제 하에 맛의 총합을 최대화하는 방법은, 앞서 보였듯이 $N-1$개의 당근을 마지막에 몰아서 먹는 겁니다. 그러면, 당근을 안 먹었을 때 보는 손해는 기존에 $x$번 당근으로부터 얻는 맛이었던 $w_x + p_x \left( T-x-1 \right)$이고, 얻는 이득은 $p_{x+1}, p_{x+2}, \cdots , p_{N-1}$의 당근을 하루 늦게 먹음으로써 늘어나는 맛으로 $\sum_{i=x+1}^{N-1}{p_i}$입니다.

$x$번 당근을 안 먹음으로써 보는 손해 중 $p_x \left( T-x-1 \right)$는 $p_x$가 $T-x-1$번 더해진 값입니다. 한편 당근을 덜 먹어서 얻는 이득은 $\sum_{i=x+1}^{N-1}{p_i}$로, $p_x$ 이하의 값을 $N-x+1$번 더한 값입니다. 그런데, $T>N$이므로 $p_x$가 $T-x-1$번 더한 값은 그 이하의 수를 $N-x+1$번 더한 값 이상일 수밖에 없습니다. 당근을 안 먹어서 보는 손해는 이보다도 $w_x$만큼 더 크므로, $x$번 당근을 안 먹으면 손해가 더 큽니다. 식으로 쓰면,

$$
\begin{aligned}
w_x &+ p_x \left( T-x-1 \right) > p_x \left( T-x-1 \right) \\
  &\geq p_x \left( N-x-1 \right) \\
  &= p_x + p_x + \cdots + p_x \\
  &\geq p_{x+1} + p_{x+2} + \cdots + p_{N-1} \\
  &= \sum_{i=x+1}^{N-1}{p_i}
\end{aligned}
$$

라는 소리와 같습니다.

결론적으로 당근을 안 먹는 것보단, 빼먹을 당근보다 $p$가 낮은 당근을 하루 일찍 먹어서라도 당근을 다 먹는 게 더 이득입니다. 따라서 정답은, 모든 당근을 다 먹고, 마지막 날에 몰아서 $p$가 작은 당근부터 전부 한 번씩 먹는 것임을 알 수 있습니다.